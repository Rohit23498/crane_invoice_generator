<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>PDF Maker - Crane Selection</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }

        h2 {
            text-align: center;
        }

        label {
            font-weight: bold;
            margin-top: 10px;
            display: block;
        }

        select,
        input,
        textarea,
        button {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            box-sizing: border-box;
        }

        textarea {
            resize: vertical;
            min-height: 60px;
        }

        button {
            cursor: pointer;
            background: #007bff;
            color: #fff;
            border: none;
            border-radius: 4px;
        }

        button:hover {
            background: #0056b3;
        }

        .dynamic-row {
            display: flex;
            gap: 5px;
            margin-bottom: 5px;
        }

        .dynamic-row select,
        .dynamic-row input {
            flex: 1;
        }

        .dynamic-row button {
            flex: 0.5;
            background: #dc3545;
        }

        .dynamic-row button:hover {
            background: #a71d2a;
        }

        #tableRows {
            margin-bottom: 10px;
        }

        #pdf-preview {
            display: block;
            padding: 20px;
            background: #fff;
            border: 1px solid #ddd;
            width: 800px;
            margin: auto;
        }

        #pdf-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        #pdf-table,
        #pdf-table th,
        #pdf-table td {
            border: 1px solid #000;
        }

        #pdf-table th,
        #pdf-table td {
            padding: 5px;
            text-align: left;
        }
    </style>
</head>

<body>

    <h2>EKTA CRANE - Quotation Maker </h2>

    <label>Quotation Reference Number:</label>
    <input type="text" id="quotationRef" placeholder="e.g., ECMPL/306/25-26" value="ECMPL/306/25-26">

    <label>Date:</label>
    <input type="date" id="quotationDate">

    <label>Time:</label>
    <input type="time" id="quotationTime">

    <h3>Client Information</h3>
    <label>Company Name:</label>
    <input type="text" id="clientCompanyInput" placeholder="Enter Company Name">

    <label>GST Number:</label>
    <input type="text" id="clientGSTInput" placeholder="Enter GST Number">

    <label>Address:</label>
    <textarea id="clientAddressInput" placeholder="Enter Complete Address" rows="3"></textarea>

    <label>Contact Number:</label>
    <input type="text" id="clientContactInput" placeholder="Enter Contact Number">

    <label>Email Address:</label>
    <input type="email" id="clientEmailInput" placeholder="Enter Email Address">

    <label>Kind Attention (Contact Person):</label>
    <input type="text" id="clientAttentionInput" placeholder="Enter Contact Person Name">

    <h3>Crane Selection Table</h3>
    <div id="tableRows"></div>
    <button type="button" onclick="addRow()">Add Row</button>
    <br>
    <button onclick="generatePDF()">Generate PDF</button>

    <!-- PDF Preview Div -->
    <div id="pdf-preview">
        <!-- EKTA CRANE Header -->
        <div style="text-align: center; margin-bottom: 20px; border-bottom: 2px solid #d32f2f; padding-bottom: 15px;">
            <!-- Company Logo and Name -->
            <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 10px;">
                <div style="width: 60px; height: 60px; background: #d32f2f; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                    <div style="color: white; font-size: 24px; font-weight: bold;">C</div>
                </div>
                <div>
                    <div style="color: #d32f2f; font-size: 18px; font-weight: bold;">EKTA CRANE</div>
                    <div style="font-size: 10px; color: #666;">ISO 9001:2015</div>
                </div>
            </div>
            
            <h1 style="color: #d32f2f; font-size: 24px; margin: 5px 0; font-weight: bold;">EKTA CRANE MANUFACTURING PVT. LTD</h1>
            <p style="font-size: 12px; margin: 2px 0; color: #666;">CIN: U28162MH2025PTC443120</p>
            
            <!-- Services -->
            <p style="font-size: 14px; margin: 8px 0; font-weight: bold;">Design, Manufacturer, Installation & Maintenance of E.O.T. Cranes and Hoist</p>
            <p style="font-size: 12px; margin: 5px 0; color: #555;">E.O.T. Crane, Goods Lift, Wire rope Hoist, Chain Pully Block & All Types of Crane Repairing & Fabrication, Material Handling System</p>
            
            <!-- Addresses -->
            <div style="display: flex; justify-content: space-between; margin: 10px 0; font-size: 11px;">
                <div style="text-align: left; flex: 1;">
                    <strong>Unit No. I:</strong><br>
                    Gala No.2, Golani Naka, Asjad Commercial Complex,<br>
                    Vasai (E), Dist - Palghar, MH., India - 401 208.
                </div>
                <div style="text-align: right; flex: 1;">
                    <strong>Unit No. II:</strong><br>
                    Survey No. 89, H.No.1, Next of Udupi Hotel,<br>
                    N.H. 8, Vasai (E), Dist - Palghar, MH., 401 208.
                </div>
            </div>
            
            <!-- Contact Information -->
            <div style="font-size: 11px; margin: 8px 0;">
                <strong>Website:</strong> www.ektacrane.com | 
                <strong>Email:</strong> ektacrane@gmail.com & ektacrane@rediffmail.com | 
                <strong>Land Line:</strong> 8446081899 / 9324634828 / 9594111331
            </div>
        </div>
        
        <!-- Quotation Details -->
        <div style="display: flex; justify-content: space-between; margin-bottom: 20px; border-bottom: 1px solid #ccc; padding-bottom: 10px;">
            <div>
                <strong>Ref. No.</strong> <span id="pdf-quotationRef">ECMPL/306/25-26</span>
            </div>
            <div style="text-align: right;">
                <h3 style="margin: 0; color: #d32f2f;">Sales Quotation Template</h3>
                <p style="margin: 5px 0 0 0; font-size: 14px;">
                    <strong>Date:</strong> <span id="pdf-date"></span> | 
                    <strong>Time:</strong> <span id="pdf-time"></span>
                </p>
            </div>
        </div>
        
        <!-- Recipient Section -->
        <div style="margin-bottom: 20px;">
            <h4 style="color: #d32f2f; margin-bottom: 10px;">To:</h4>
            <div style="border: 1px solid #ddd; padding: 15px; background: #f9f9f9;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <div>
                        <strong>Company Name:</strong> <input type="text" id="clientCompany" placeholder="Enter Company Name" style="border: none; background: transparent; font-weight: bold; width: 300px;">
                    </div>
                    <div>
                        <strong>GST No:</strong> <input type="text" id="clientGST" placeholder="Enter GST Number" style="border: none; background: transparent; width: 150px;">
                    </div>
                </div>
                <div style="margin-bottom: 8px;">
                    <strong>Address:</strong> <input type="text" id="clientAddress" placeholder="Enter Complete Address" style="border: none; background: transparent; width: 100%;">
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <div>
                        <strong>Contact:</strong> <input type="text" id="clientContact" placeholder="Enter Contact Number" style="border: none; background: transparent; width: 150px;">
                    </div>
                    <div>
                        <strong>Email:</strong> <input type="text" id="clientEmail" placeholder="Enter Email Address" style="border: none; background: transparent; width: 200px;">
                    </div>
                </div>
                <div style="margin-top: 10px; text-align: center;">
                    <strong>Kind Attention:</strong> <input type="text" id="clientAttention" placeholder="Enter Contact Person Name" style="border: none; background: transparent; font-weight: bold; width: 200px;">
                </div>
            </div>
        </div>
        <table id="pdf-table">
            <thead>
                <tr>
                    <th>Crane Type</th>
                    <th>Capacity (Tonnes)</th>
                    <th>Qty</th>
                    <th>Rate (Rs.)</th>
                    <th>Amt (Rs.)</th>
                </tr>
            </thead>
            <tbody></tbody>
            <tfoot>
                <tr>
                    <td colspan="4" style="text-align:right; font-weight:bold;">Sub Total</td>
                    <td id="pdf-subtotal" style="font-weight:bold;"></td>
                </tr>
            </tfoot>
        </table>
        
        <!-- Crane Images Section -->
        <div id="crane-images-section" style="margin: 20px 0; text-align: center;">
            <h4>Selected Crane Images</h4>
            <div id="crane-images-container" style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px;">
                <!-- Images will be dynamically added here -->
            </div>
        </div>
        
        <h4>Terms & Conditions</h4>
        <ul style="font-size:12px; line-height:1.5;">
            <li><b>WARRANTY:</b> 1 YEAR DOMESTIC WARRANTY, INCLUDING ONLY PARTS & LABOR DEFECTS BUT NOT THE DEFECTS DUE TO EXTERNAL CAUSES ACCIDENTAL OR PHYSICAL DAMAGES</li>
            <li><b>BANK DETAILS:</b> BANK OF INDIA A/C: 017820110000188 (IFSC: BKID0000178) BRANCH (VASAI WEST)</li>
            <li><b>GST NO:</b> 27AAICE7407Q1Z0 | <b>PAN No:</b> AAICE7407Q</li>
            <li><b>PAYMENTS:</b> 50% ADVANCE WITH PURCHASE ORDER & 40% BEFORE DISPATCH & 10% BALANCE AFTER TESTING</li>
            <li><b>DELIVERY PERIOD:</b> WITHIN 3-4 MONTH WORKING DAYS FROM THE DATE OF CONFIRMED PO ALONG WITH ADVANCE</li>
        </ul>
        <p>This is computer generated Quotation does not require any signature and stamp.</p>
    </div>

    <script>
        // Crane images mapping
        const craneImages = {
            "Single Girder EOT Crane": {
                "0.5 Tonne": "https://via.placeholder.com/200x150/4CAF50/white?text=Single+Girder+EOT+0.5T",
                "1 Tonne": "https://via.placeholder.com/200x150/4CAF50/white?text=Single+Girder+EOT+1T",
                "2 Tonne": "https://via.placeholder.com/200x150/4CAF50/white?text=Single+Girder+EOT+2T",
                "5 Tonne": "https://via.placeholder.com/200x150/4CAF50/white?text=Single+Girder+EOT+5T",
                "10 Tonne": "https://via.placeholder.com/200x150/4CAF50/white?text=Single+Girder+EOT+10T",
                "15 Tonne": "https://via.placeholder.com/200x150/4CAF50/white?text=Single+Girder+EOT+15T",
                "20 Tonne": "https://via.placeholder.com/200x150/4CAF50/white?text=Single+Girder+EOT+20T",
                "Others": "https://via.placeholder.com/200x150/4CAF50/white?text=Single+Girder+EOT+Custom"
            },
            "Double Girder EOT Crane": {
                "2 Tonne": "https://via.placeholder.com/200x150/2196F3/white?text=Double+Girder+EOT+2T",
                "5 Tonne": "https://via.placeholder.com/200x150/2196F3/white?text=Double+Girder+EOT+5T",
                "10 Tonne": "https://via.placeholder.com/200x150/2196F3/white?text=Double+Girder+EOT+10T",
                "50 Tonne": "https://via.placeholder.com/200x150/2196F3/white?text=Double+Girder+EOT+50T",
                "100 Tonne": "https://via.placeholder.com/200x150/2196F3/white?text=Double+Girder+EOT+100T",
                "150 Tonne": "https://via.placeholder.com/200x150/2196F3/white?text=Double+Girder+EOT+150T",
                "250 Tonne": "https://via.placeholder.com/200x150/2196F3/white?text=Double+Girder+EOT+250T",
                "Others": "https://via.placeholder.com/200x150/2196F3/white?text=Double+Girder+EOT+Custom"
            },
            "Underslung EOT Crane": {
                "0.5 Tonne": "https://via.placeholder.com/200x150/FF9800/white?text=Underslung+EOT+0.5T",
                "1 Tonne": "https://via.placeholder.com/200x150/FF9800/white?text=Underslung+EOT+1T",
                "2 Tonne": "https://via.placeholder.com/200x150/FF9800/white?text=Underslung+EOT+2T",
                "5 Tonne": "https://via.placeholder.com/200x150/FF9800/white?text=Underslung+EOT+5T",
                "10 Tonne": "https://via.placeholder.com/200x150/FF9800/white?text=Underslung+EOT+10T",
                "Others": "https://via.placeholder.com/200x150/FF9800/white?text=Underslung+EOT+Custom"
            },
            "Single Girder Gantry Crane": {
                "1 Tonne": "https://via.placeholder.com/200x150/9C27B0/white?text=Single+Girder+Gantry+1T",
                "2 Tonne": "https://via.placeholder.com/200x150/9C27B0/white?text=Single+Girder+Gantry+2T",
                "5 Tonne": "https://via.placeholder.com/200x150/9C27B0/white?text=Single+Girder+Gantry+5T",
                "10 Tonne": "https://via.placeholder.com/200x150/9C27B0/white?text=Single+Girder+Gantry+10T",
                "15 Tonne": "https://via.placeholder.com/200x150/9C27B0/white?text=Single+Girder+Gantry+15T",
                "20 Tonne": "https://via.placeholder.com/200x150/9C27B0/white?text=Single+Girder+Gantry+20T",
                "Others": "https://via.placeholder.com/200x150/9C27B0/white?text=Single+Girder+Gantry+Custom"
            },
            "Double Girder Gantry Crane": {
                "5 Tonne": "https://via.placeholder.com/200x150/E91E63/white?text=Double+Girder+Gantry+5T",
                "10 Tonne": "https://via.placeholder.com/200x150/E91E63/white?text=Double+Girder+Gantry+10T",
                "50 Tonne": "https://via.placeholder.com/200x150/E91E63/white?text=Double+Girder+Gantry+50T",
                "100 Tonne": "https://via.placeholder.com/200x150/E91E63/white?text=Double+Girder+Gantry+100T",
                "200 Tonne": "https://via.placeholder.com/200x150/E91E63/white?text=Double+Girder+Gantry+200T",
                "500 Tonne": "https://via.placeholder.com/200x150/E91E63/white?text=Double+Girder+Gantry+500T",
                "Others": "https://via.placeholder.com/200x150/E91E63/white?text=Double+Girder+Gantry+Custom"
            },
            "Semi Gantry Crane": {
                "2 Tonne": "https://via.placeholder.com/200x150/795548/white?text=Semi+Gantry+2T",
                "5 Tonne": "https://via.placeholder.com/200x150/795548/white?text=Semi+Gantry+5T",
                "10 Tonne": "https://via.placeholder.com/200x150/795548/white?text=Semi+Gantry+10T",
                "15 Tonne": "https://via.placeholder.com/200x150/795548/white?text=Semi+Gantry+15T",
                "20 Tonne": "https://via.placeholder.com/200x150/795548/white?text=Semi+Gantry+20T",
                "50 Tonne": "https://via.placeholder.com/200x150/795548/white?text=Semi+Gantry+50T",
                "80 Tonne": "https://via.placeholder.com/200x150/795548/white?text=Semi+Gantry+80T",
                "Others": "https://via.placeholder.com/200x150/795548/white?text=Semi+Gantry+Custom"
            },
            "Wall Mounted Jib Crane": {
                "0.5 Tonne": "https://via.placeholder.com/200x150/607D8B/white?text=Wall+Jib+0.5T",
                "1 Tonne": "https://via.placeholder.com/200x150/607D8B/white?text=Wall+Jib+1T",
                "2 Tonne": "https://via.placeholder.com/200x150/607D8B/white?text=Wall+Jib+2T",
                "5 Tonne": "https://via.placeholder.com/200x150/607D8B/white?text=Wall+Jib+5T",
                "10 Tonne": "https://via.placeholder.com/200x150/607D8B/white?text=Wall+Jib+10T",
                "16 Tonne": "https://via.placeholder.com/200x150/607D8B/white?text=Wall+Jib+16T",
                "Others": "https://via.placeholder.com/200x150/607D8B/white?text=Wall+Jib+Custom"
            },
            "Pillar Mounted Jib Crane": {
                "0.5 Tonne": "https://via.placeholder.com/200x150/3F51B5/white?text=Pillar+Jib+0.5T",
                "1 Tonne": "https://via.placeholder.com/200x150/3F51B5/white?text=Pillar+Jib+1T",
                "2 Tonne": "https://via.placeholder.com/200x150/3F51B5/white?text=Pillar+Jib+2T",
                "5 Tonne": "https://via.placeholder.com/200x150/3F51B5/white?text=Pillar+Jib+5T",
                "10 Tonne": "https://via.placeholder.com/200x150/3F51B5/white?text=Pillar+Jib+10T",
                "16 Tonne": "https://via.placeholder.com/200x150/3F51B5/white?text=Pillar+Jib+16T",
                "Others": "https://via.placeholder.com/200x150/3F51B5/white?text=Pillar+Jib+Custom"
            },
            "Container Crane": {
                "20 Tonne": "https://via.placeholder.com/200x150/FF5722/white?text=Container+20T",
                "45 Tonne": "https://via.placeholder.com/200x150/FF5722/white?text=Container+45T",
                "Others": "https://via.placeholder.com/200x150/FF5722/white?text=Container+Custom"
            },
            "Small Gantry Crane": {
                "0.25 Tonne": "https://via.placeholder.com/200x150/8BC34A/white?text=Small+Gantry+0.25T",
                "0.50 Tonne": "https://via.placeholder.com/200x150/8BC34A/white?text=Small+Gantry+0.5T",
                "1 Tonne": "https://via.placeholder.com/200x150/8BC34A/white?text=Small+Gantry+1T",
                "2 Tonne": "https://via.placeholder.com/200x150/8BC34A/white?text=Small+Gantry+2T",
                "5 Tonne": "https://via.placeholder.com/200x150/8BC34A/white?text=Small+Gantry+5T",
                "10 Tonne": "https://via.placeholder.com/200x150/8BC34A/white?text=Small+Gantry+10T",
                "Others": "https://via.placeholder.com/200x150/8BC34A/white?text=Small+Gantry+Custom"
            },
            "Wire Rope Electric Hoist": {
                "0.5 Tonne": "https://via.placeholder.com/200x150/00BCD4/white?text=Wire+Rope+0.5T",
                "1 Tonne": "https://via.placeholder.com/200x150/00BCD4/white?text=Wire+Rope+1T",
                "2 Tonne": "https://via.placeholder.com/200x150/00BCD4/white?text=Wire+Rope+2T",
                "5 Tonne": "https://via.placeholder.com/200x150/00BCD4/white?text=Wire+Rope+5T",
                "10 Tonne": "https://via.placeholder.com/200x150/00BCD4/white?text=Wire+Rope+10T",
                "20 Tonne": "https://via.placeholder.com/200x150/00BCD4/white?text=Wire+Rope+20T",
                "36 Tonne": "https://via.placeholder.com/200x150/00BCD4/white?text=Wire+Rope+36T",
                "Others": "https://via.placeholder.com/200x150/00BCD4/white?text=Wire+Rope+Custom"
            },
            "Electric Chain Hoist": {
                "0.5 Tonne": "https://via.placeholder.com/200x150/CDDC39/white?text=Chain+Hoist+0.5T",
                "1 Tonne": "https://via.placeholder.com/200x150/CDDC39/white?text=Chain+Hoist+1T",
                "2 Tonne": "https://via.placeholder.com/200x150/CDDC39/white?text=Chain+Hoist+2T",
                "5 Tonne": "https://via.placeholder.com/200x150/CDDC39/white?text=Chain+Hoist+5T",
                "10 Tonne": "https://via.placeholder.com/200x150/CDDC39/white?text=Chain+Hoist+10T",
                "15 Tonne": "https://via.placeholder.com/200x150/CDDC39/white?text=Chain+Hoist+15T",
                "25 Tonne": "https://via.placeholder.com/200x150/CDDC39/white?text=Chain+Hoist+25T",
                "35 Tonne": "https://via.placeholder.com/200x150/CDDC39/white?text=Chain+Hoist+35T",
                "Others": "https://via.placeholder.com/200x150/CDDC39/white?text=Chain+Hoist+Custom"
            }
        };

        // JSON data for cranes and capacities
        const cranesData = {
            "Single Girder EOT Crane": ["0.5 Tonne", "1 Tonne", "2 Tonne", "5 Tonne", "10 Tonne", "15 Tonne", "20 Tonne", "Others"],
            "Double Girder EOT Crane": ["2 Tonne", "5 Tonne", "10 Tonne", "50 Tonne", "100 Tonne", "150 Tonne", "250 Tonne", "Others"],
            "Underslung EOT Crane": ["0.5 Tonne", "1 Tonne", "2 Tonne", "5 Tonne", "10 Tonne", "Others"],
            "Single Girder Gantry Crane": ["1 Tonne", "2 Tonne", "5 Tonne", "10 Tonne", "15 Tonne", "20 Tonne", "Others"],
            "Double Girder Gantry Crane": ["5 Tonne", "10 Tonne", "50 Tonne", "100 Tonne", "200 Tonne", "500 Tonne", "Others"],
            "Semi Gantry Crane": ["2 Tonne", "5 Tonne", "10 Tonne", "15 Tonne", "20 Tonne", "50 Tonne", "80 Tonne", "Others"],
            "Wall Mounted Jib Crane": ["0.5 Tonne", "1 Tonne", "2 Tonne", "5 Tonne", "10 Tonne", "16 Tonne", "Others"],
            "Pillar Mounted Jib Crane": ["0.5 Tonne", "1 Tonne", "2 Tonne", "5 Tonne", "10 Tonne", "16 Tonne", "Others"],
            "Container Crane": ["20 Tonne", "45 Tonne", "Others"],
            "Small Gantry Crane": ["0.25 Tonne", "0.50 Tonne", "1 Tonne", "2 Tonne", "5 Tonne", "10 Tonne", "Others"],
            "Wire Rope Electric Hoist": ["0.5 Tonne", "1 Tonne", "2 Tonne", "5 Tonne", "10 Tonne", "20 Tonne", "36 Tonne", "Others"],
            "Electric Chain Hoist": ["0.5 Tonne", "1 Tonne", "2 Tonne", "5 Tonne", "10 Tonne", "15 Tonne", "25 Tonne", "35 Tonne", "Others"]
        };

        function addRow(crane = '', capacity = '', qty = 0, rate = 0) {
            const div = document.createElement('div');
            div.classList.add('dynamic-row');

            // Crane dropdown
            const craneSelect = document.createElement('select');
            for (const craneType in cranesData) {
                const option = document.createElement('option');
                option.value = craneType;
                option.textContent = craneType;
                if (craneType === crane) option.selected = true;
                craneSelect.appendChild(option);
            }

            // Capacity dropdown
            const capacitySelect = document.createElement('select');
            function updateCapacityOptions(selectedCrane) {
                capacitySelect.innerHTML = '';
                cranesData[selectedCrane].forEach(cap => {
                    const opt = document.createElement('option');
                    opt.value = cap;
                    opt.textContent = cap;
                    if (cap == capacity) opt.selected = true;
                    capacitySelect.appendChild(opt);
                });
            }
            updateCapacityOptions(craneSelect.value);

            // Show input if 'Other' is selected
            const otherInput = document.createElement('input');
            otherInput.type = 'number';
            otherInput.placeholder = 'Enter capacity';
            otherInput.style.display = capacitySelect.value === 'Other' ? 'block' : 'none';
            if (capacitySelect.value !== 'Other') otherInput.value = '';

            capacitySelect.addEventListener('change', () => {
                if (capacitySelect.value === 'Other') {
                    otherInput.style.display = 'block';
                } else {
                    otherInput.style.display = 'none';
                    otherInput.value = '';
                }
            });

            craneSelect.addEventListener('change', () => {
                updateCapacityOptions(craneSelect.value);
                if (capacitySelect.value === 'Other') otherInput.style.display = 'block';
                else otherInput.style.display = 'none';
                updateCraneImages(); // Update images when crane changes
            });

            capacitySelect.addEventListener('change', () => {
                if (capacitySelect.value === 'Other') {
                    otherInput.style.display = 'block';
                } else {
                    otherInput.style.display = 'none';
                    otherInput.value = '';
                }
                updateCraneImages(); // Update images when capacity changes
            });

            otherInput.addEventListener('input', () => {
                updateCraneImages(); // Update images when custom capacity is entered
            });

            // Quantity, Rate, Amount
            const qtyInput = document.createElement('input');
            qtyInput.type = 'number'; qtyInput.value = qty; qtyInput.placeholder = 'Qty';
            qtyInput.min = 0; qtyInput.oninput = () => calculateAmt(div);

            const rateInput = document.createElement('input');
            rateInput.type = 'number'; rateInput.value = rate; rateInput.placeholder = 'Rate';
            rateInput.min = 0; rateInput.oninput = () => calculateAmt(div);

            const amtInput = document.createElement('input');
            amtInput.type = 'number'; amtInput.placeholder = 'Amt'; amtInput.value = 0; amtInput.readOnly = true;

            const removeBtn = document.createElement('button');
            removeBtn.type = 'button'; removeBtn.textContent = 'Remove';
            removeBtn.onclick = () => {
                div.remove();
                updateCraneImages(); // Update images when row is removed
            };

            div.appendChild(craneSelect);
            div.appendChild(capacitySelect);
            div.appendChild(otherInput);
            div.appendChild(qtyInput);
            div.appendChild(rateInput);
            div.appendChild(amtInput);
            div.appendChild(removeBtn);

            document.getElementById('tableRows').appendChild(div);
        }

        function calculateAmt(row) {
            const qty = parseFloat(row.children[3].value) || 0;
            const rate = parseFloat(row.children[4].value) || 0;
            row.children[5].value = qty * rate;
        }

        function updateCraneImages() {
            const container = document.getElementById('crane-images-container');
            container.innerHTML = '';
            
            // Get unique crane selections
            const selectedCranes = new Set();
            document.querySelectorAll('#tableRows .dynamic-row').forEach(row => {
                const crane = row.children[0].value;
                let capacity = row.children[1].value;
                if (capacity === 'Other') capacity = row.children[2].value || 'Others';
                selectedCranes.add(JSON.stringify({crane, capacity}));
            });

            selectedCranes.forEach(craneData => {
                const {crane, capacity} = JSON.parse(craneData);
                const imageUrl = craneImages[crane] && craneImages[crane][capacity] 
                    ? craneImages[crane][capacity] 
                    : 'https://via.placeholder.com/200x150/CCCCCC/white?text=No+Image';
                
                const imageDiv = document.createElement('div');
                imageDiv.style.textAlign = 'center';
                imageDiv.style.margin = '5px';
                
                const img = document.createElement('img');
                img.src = imageUrl;
                img.style.width = '200px';
                img.style.height = '150px';
                img.style.border = '1px solid #ddd';
                img.style.borderRadius = '5px';
                
                const label = document.createElement('div');
                label.textContent = `${crane} - ${capacity}`;
                label.style.fontSize = '12px';
                label.style.marginTop = '5px';
                label.style.fontWeight = 'bold';
                
                imageDiv.appendChild(img);
                imageDiv.appendChild(label);
                container.appendChild(imageDiv);
            });
        }

        function generatePDF() {
            const pdfPreview = document.getElementById('pdf-preview');
            const pdfTableBody = document.querySelector('#pdf-table tbody');
            const pdfSubtotal = document.getElementById('pdf-subtotal');
            const pdfDate = document.getElementById('pdf-date');
            const pdfTime = document.getElementById('pdf-time');
            const pdfQuotationRef = document.getElementById('pdf-quotationRef');

            // Set current date and time if not provided
            const quotationDate = document.getElementById('quotationDate').value || new Date().toISOString().split('T')[0];
            const quotationTime = document.getElementById('quotationTime').value || new Date().toTimeString().split(' ')[0].substring(0, 5);
            const quotationRef = document.getElementById('quotationRef').value || 'ECMPL/306/25-26';
            
            pdfDate.textContent = quotationDate;
            pdfTime.textContent = quotationTime;
            pdfQuotationRef.textContent = quotationRef;

            // Update client information
            document.getElementById('clientCompany').value = document.getElementById('clientCompanyInput').value || '';
            document.getElementById('clientGST').value = document.getElementById('clientGSTInput').value || '';
            document.getElementById('clientAddress').value = document.getElementById('clientAddressInput').value || '';
            document.getElementById('clientContact').value = document.getElementById('clientContactInput').value || '';
            document.getElementById('clientEmail').value = document.getElementById('clientEmailInput').value || '';
            document.getElementById('clientAttention').value = document.getElementById('clientAttentionInput').value || '';

            // Update crane images
            updateCraneImages();

            pdfTableBody.innerHTML = '';
            let subtotal = 0;

            document.querySelectorAll('#tableRows .dynamic-row').forEach(row => {
                const crane = row.children[0].value;
                let capacity = row.children[1].value;
                if (capacity === 'Other') capacity = row.children[2].value || 'N/A';
                const qty = row.children[3].value;
                const rate = row.children[4].value;
                const amt = row.children[5].value;

                subtotal += parseFloat(amt) || 0;

                const tr = document.createElement('tr');
                tr.innerHTML = `<td>${crane}</td><td>${capacity}</td><td>${qty}</td><td>${rate}</td><td>${amt}</td>`;
                pdfTableBody.appendChild(tr);
            });

            pdfSubtotal.textContent = subtotal.toLocaleString("en-IN");

            // Generate PDF directly
            html2canvas(pdfPreview, { backgroundColor: '#ffffff', scale: 2 }).then(canvas => {
                const imgData = canvas.toDataURL('image/jpeg');
                const pdf = new window.jspdf.jsPDF('p', 'pt', 'a4');
                const pdfWidth = pdf.internal.pageSize.getWidth();
                const pdfHeight = (canvas.height * pdfWidth) / canvas.width;
                pdf.addImage(imgData, 'JPEG', 0, 0, pdfWidth, pdfHeight);
                pdf.save('ekta-crane-quotation.pdf');
            });
        }

        // Initialize with default values
        document.getElementById('quotationDate').value = new Date().toISOString().split('T')[0];
        document.getElementById('quotationTime').value = new Date().toTimeString().split(' ')[0].substring(0, 5);
        
        addRow(); // initialize with one row
    </script>

</body>

</html>
