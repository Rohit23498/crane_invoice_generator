<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>PDF Maker - Crane Selection</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
            min-height: 100vh;
            padding: 20px;
            color: #fafafa;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(42, 42, 42, 0.85);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            border: 1px solid #333333;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #D4AF37 0%, #c5a028 100%);
            color: #1a1a1a;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .form-container {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
            background: rgba(42, 42, 42, 0.6);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            border: 1px solid #333333;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #fafafa;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title::before {
            content: '';
            width: 4px;
            height: 24px;
            background: linear-gradient(135deg, #D4AF37, #c5a028);
            border-radius: 2px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        label {
            font-weight: 600;
            color: #D4AF37;
            margin-bottom: 8px;
            font-size: 0.95rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        input, select, textarea {
            padding: 14px 16px;
            border: 2px solid #333333;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: rgba(42, 42, 42, 0.8);
            color: #fafafa;
            backdrop-filter: blur(5px);
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #D4AF37;
            background: rgba(42, 42, 42, 0.95);
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.2);
            transform: translateY(-2px);
        }

        textarea {
            resize: vertical;
            min-height: 80px;
            font-family: inherit;
        }

        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            text-decoration: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, #D4AF37, #c5a028);
            color: #1a1a1a;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #2a2a2a, #1a1a1a);
            color: #fafafa;
            box-shadow: 0 4px 15px rgba(42, 42, 42, 0.3);
            border: 1px solid #333333;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(42, 42, 42, 0.4);
            border-color: #D4AF37;
        }

        .btn-danger {
            background: linear-gradient(135deg, #e53e3e, #c53030);
            color: white;
            box-shadow: 0 4px 15px rgba(229, 62, 62, 0.3);
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(229, 62, 62, 0.4);
        }

        .dynamic-row {
            display: grid;
            grid-template-columns: 2fr 1.5fr 0.8fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
            align-items: end;
            background: rgba(42, 42, 42, 0.6);
            backdrop-filter: blur(5px);
            padding: 20px;
            border-radius: 16px;
            border: 1px solid #333333;
            transition: all 0.3s ease;
        }

        .dynamic-row:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            border-color: rgba(212, 175, 55, 0.5);
        }

        input::placeholder, select::placeholder, textarea::placeholder {
            color: #8a8a8a;
            opacity: 1;
        }

        .dynamic-row select,
        .dynamic-row input {
            margin-bottom: 0;
            min-width: 0;
        }

        .dynamic-row .btn-danger {
            padding: 12px 16px;
            white-space: nowrap;
        }

        .dynamic-row input[type="number"] {
            text-align: center;
        }

        #tableRows {
            margin-bottom: 20px;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            justify-content: center;
        }

        #pdf-preview {
            display: block;
            padding: 30px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            margin: 30px auto;
            max-width: 800px;
        }

        #pdf-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }

        #pdf-table th {
            background: linear-gradient(135deg, #D4AF37, #c5a028);
            color: #1a1a1a;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        #pdf-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e8e8e8;
            font-size: 14px;
            color: #333;
        }

        #pdf-table tbody tr:nth-child(even) {
            background: #fafafa;
        }

        #pdf-table tbody tr:nth-child(odd) {
            background: white;
        }

        #pdf-table tbody tr:hover {
            background: #f0f8ff !important;
            transition: background 0.2s ease;
        }

        #pdf-table tbody td:first-child {
            font-weight: 500;
            color: #D4AF37;
        }

        #pdf-table tbody td:nth-child(2) {
            text-align: center;
            font-weight: 500;
        }

        #pdf-table tbody td:nth-child(3) {
            text-align: center;
            font-weight: 600;
            color: #2c5aa0;
        }

        #pdf-table tbody td:nth-child(4),
        #pdf-table tbody td:nth-child(5) {
            text-align: right;
            font-weight: 600;
        }

        #pdf-table tbody td:nth-child(5) {
            color: #2e7d32;
        }

        .crane-images-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .crane-image-item {
            text-align: center;
            background: white;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border: 2px solid #D4AF37;
            transition: all 0.3s ease;
        }

        .crane-image-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .crane-image-item img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 12px;
            border: 1px solid #ddd;
        }

        .crane-image-item .label {
            font-size: 14px;
            font-weight: 600;
            color: #D4AF37;
            background: #f8f9fa;
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid #D4AF37;
            display: inline-block;
            margin-top: 5px;
        }

        /* Empty state message for crane images */
        .crane-images-empty {
            text-align: center;
            padding: 40px 20px;
            color: #666;
            font-style: italic;
            background: white;
            border-radius: 8px;
            border: 2px dashed #D4AF37;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .dynamic-row {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .dynamic-row > div {
                display: flex;
                flex-direction: column;
                gap: 5px;
            }
            
            .dynamic-row > div:last-child {
                flex-direction: row;
                justify-content: center;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }

        @media (max-width: 1024px) {
            .dynamic-row {
                grid-template-columns: 1.8fr 1.2fr 0.7fr 0.9fr 0.9fr;
                gap: 8px;
            }
        }

        /* PDF Preview Mobile Responsiveness */
        @media (max-width: 768px) {
            #pdf-preview {
                padding: 15px;
                margin: 15px;
            }

            /* Make client info section stack on mobile */
            .client-info-grid {
                display: block !important;
                gap: 0 !important;
            }

            .client-info-grid > div {
                margin-bottom: 15px !important;
            }

            .client-info-grid input,
            .client-info-grid textarea {
                width: 100% !important;
                font-size: 16px !important; /* Prevents zoom on iOS */
            }

            /* Table responsiveness */
            #pdf-table {
                font-size: 12px;
            }

            #pdf-table th,
            #pdf-table td {
                padding: 8px 6px;
            }

            /* Quotation details mobile layout */
            .quotation-details-grid {
                grid-template-columns: 1fr !important;
                text-align: center !important;
                gap: 15px !important;
            }
        }

        @media (max-width: 480px) {
            /* Stack table headers vertically on very small screens */
            #pdf-table thead th {
                font-size: 11px;
                padding: 6px 4px;
            }

            #pdf-table tbody td {
                font-size: 11px;
                padding: 6px 4px;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>EKTA CRANE</h1>
            <p>Professional Quotation </p>
        </div>
        
        <div class="form-container">
            <!-- Quotation Details Section -->
            <div class="section">
                <h2 class="section-title">üìã Quotation Details</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Quotation Reference Number</label>
                        <input type="text" id="quotationRef" placeholder="e.g., ECMPL/306/25-26" value="ECMPL/306/25-26">
                    </div>
                    <div class="form-group">
                        <label>Date</label>
                        <input type="date" id="quotationDate">
                    </div>
                    <div class="form-group">
                        <label>Time</label>
                        <input type="time" id="quotationTime">
                    </div>
                </div>
            </div>

            <!-- Client Information Section -->
            <div class="section">
                <h2 class="section-title">üë§ Client Information</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Company Name</label>
                        <input type="text" id="clientCompanyInput" placeholder="Enter Company Name">
                    </div>
                    <div class="form-group">
                        <label>GST Number</label>
                        <input type="text" id="clientGSTInput" placeholder="Enter GST Number">
                    </div>
                    <div class="form-group">
                        <label>Contact Number</label>
                        <input type="text" id="clientContactInput" placeholder="Enter Contact Number">
                    </div>
                    <div class="form-group">
                        <label>Email Address</label>
                        <input type="email" id="clientEmailInput" placeholder="Enter Email Address">
                    </div>
                    <div class="form-group">
                        <label>Kind Attention (Contact Person)</label>
                        <input type="text" id="clientAttentionInput" placeholder="Enter Contact Person Name">
                    </div>
                </div>
                <div class="form-group">
                    <label>Address</label>
                    <textarea id="clientAddressInput" placeholder="Enter Complete Address" rows="3"></textarea>
                </div>
            </div>

            <!-- Crane Selection Section -->
            <div class="section">
                <h2 class="section-title">üèóÔ∏è Crane Selection</h2>
                
                <!-- Column Headers -->
                <div class="dynamic-row" style="background: #e2e8f0; font-weight: 600; color: #4a5568; margin-bottom: 10px;">
                    <div style="display: flex; align-items: center;">Crane Type</div>
                    <div style="display: flex; align-items: center;">Capacity</div>
                    <div style="display: flex; align-items: center;">Custom</div>
                    <div style="display: flex; align-items: center;">Qty</div>
                    <div style="display: flex; align-items: center;">Rate (‚Çπ)</div>
                    <div style="display: flex; align-items: center;">Amount (‚Çπ)</div>
                    <div style="display: flex; align-items: center;">Action</div>
                </div>
                
    <div id="tableRows"></div>
                <div class="action-buttons">
                    <button type="button" onclick="addRow()" class="btn btn-secondary">
                        ‚ûï Add Row
                    </button>
                    <button onclick="generatePDF()" class="btn btn-primary">
                        üìÑ Generate PDF
                    </button>
                </div>
            </div>
        </div>

    <!-- PDF Preview Div -->
    <div id="pdf-preview">
        <!-- EKTA CRANE Header -->
        <div style="text-align: center; margin-bottom: 20px; border-bottom: 2px solid #D4AF37; padding-bottom: 15px;">
            <!-- Company Logo and Name -->
            <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 10px;">
                <div style="width: 80px; height: 80px; margin-right: 20px; position: relative;">
                    <svg width="80" height="80" viewBox="0 0 80 80" style="position: absolute; top: 0; left: 0;">
                        <!-- Outer gear-like circle -->
                        <circle cx="40" cy="40" r="38" fill="#D4AF37" stroke="#D4AF37" stroke-width="2"/>
                        <!-- Gear teeth pattern -->
                        <g fill="#D4AF37">
                            <rect x="38" y="2" width="4" height="8" rx="2"/>
                            <rect x="70" y="38" width="8" height="4" ry="2"/>
                            <rect x="38" y="70" width="4" height="8" rx="2"/>
                            <rect x="2" y="38" width="8" height="4" ry="2"/>
                            <rect x="65" y="15" width="6" height="4" rx="2" transform="rotate(45 68 17)"/>
                            <rect x="65" y="61" width="6" height="4" rx="2" transform="rotate(-45 68 63)"/>
                            <rect x="9" y="15" width="6" height="4" rx="2" transform="rotate(-45 12 17)"/>
                            <rect x="9" y="61" width="6" height="4" rx="2" transform="rotate(45 12 63)"/>
                        </g>
                        <!-- Inner C with crane hook -->
                        <g fill="white">
                            <!-- Left half of C -->
                            <path d="M25 20 Q20 20 20 25 L20 35 Q20 40 25 40 L30 40 L30 25 Q30 20 25 20 Z"/>
                            <!-- Right half of C -->
                            <path d="M55 20 Q60 20 60 25 L60 35 Q60 40 55 40 L50 40 L50 25 Q50 20 55 20 Z"/>
                            <!-- Crane hook -->
                            <path d="M35 45 L35 55 Q35 60 40 60 L45 60 Q50 60 50 55 L50 50 Q50 45 45 45 L40 45 Q35 45 35 50 Z"/>
                        </g>
                        <!-- Registered trademark symbol -->
                        <text x="65" y="25" fill="white" font-size="8" font-weight="bold" font-family="Arial">¬Æ</text>
                    </svg>
                </div>
                <div>
                    <div style="color: #D4AF37; font-size: 20px; font-weight: bold; letter-spacing: 1px;">EKTA CRANE</div>
                    <div style="font-size: 11px; color: #D4AF37; font-weight: 600; letter-spacing: 0.5px;">ISO 9001:2015</div>
                </div>
            </div>
            
            <h1 style="color: #D4AF37; font-size: 24px; margin: 5px 0; font-weight: bold;">EKTA CRANE MANUFACTURING PVT. LTD</h1>
            <p style="font-size: 12px; margin: 2px 0; color: #666;">CIN: U28162MH2025PTC443120</p>
            
            <!-- Services -->
            <p style="font-size: 14px; margin: 8px 0; font-weight: bold;">Design, Manufacturer, Installation & Maintenance of E.O.T. Cranes and Hoist</p>
            <p style="font-size: 12px; margin: 5px 0; color: #555;">E.O.T. Crane, Goods Lift, Wire rope Hoist, Chain Pully Block & All Types of Crane Repairing & Fabrication, Material Handling System</p>
            
            <!-- Addresses -->
            <div style="display: flex; justify-content: space-between; margin: 10px 0; font-size: 11px;">
                <div style="text-align: left; flex: 1;">
                    <strong>Unit No. I:</strong><br>
                    Gala No.2, Golani Naka, Asjad Commercial Complex,<br>
                    Vasai (E), Dist - Palghar, MH., India - 401 208.
                </div>
                <div style="text-align: right; flex: 1;">
                    <strong>Unit No. II:</strong><br>
                    Survey No. 89, H.No.1, Next of Udupi Hotel,<br>
                    N.H. 8, Vasai (E), Dist - Palghar, MH., 401 208.
                </div>
            </div>
            
            <!-- Contact Information -->
            <div style="font-size: 11px; margin: 8px 0;">
                <strong>Website:</strong> www.ektacrane.com | 
                <strong>Email:</strong> ektacrane@gmail.com & ektacrane@rediffmail.com | 
                <strong>Land Line:</strong> 8446081899 / 9324634828 / 9594111331
            </div>
        </div>
        
        <!-- Quotation Details -->
        <div class="quotation-details-grid" style="display: grid; grid-template-columns: 1fr auto; gap: 20px; margin-bottom: 25px; border-bottom: 2px solid #D4AF37; padding-bottom: 15px; align-items: center;">
            <div style="display: flex; flex-direction: column; gap: 8px;">
                <div style="background: #f0f8ff; padding: 8px 12px; border-radius: 4px; border-left: 4px solid #D4AF37;">
                    <strong style="color: #D4AF37; font-size: 12px;">REFERENCE NUMBER:</strong><br>
                    <span id="pdf-quotationRef" style="font-size: 16px; font-weight: 600; color: #333;">ECMPL/306/25-26</span>
                </div>
            </div>
            <div style="text-align: right;">
                <h3 style="margin: 0 0 10px 0; color: #D4AF37; font-size: 20px; font-weight: bold;">Sales Quotation Template</h3>
                <div style="background: #fff8e1; padding: 8px 12px; border-radius: 4px; border-right: 4px solid #D4AF37;">
                    <div style="font-size: 14px; color: #666;">
                        <strong style="color: #D4AF37;">DATE:</strong> <span id="pdf-date" style="color: #333; font-weight: 600;"></span>
                    </div>
                    <div style="font-size: 14px; color: #666; margin-top: 4px;">
                        <strong style="color: #D4AF37;">TIME:</strong> <span id="pdf-time" style="color: #333; font-weight: 600;"></span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Recipient Section -->
        <div style="margin-bottom: 25px;">
            <h4 style="color: #D4AF37; margin-bottom: 15px; font-size: 16px; font-weight: bold;">To:</h4>
            <div style="border: 2px solid #D4AF37; padding: 20px; background: #fafafa; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                
                <!-- Row 1: Company Name and GST -->
                <div class="client-info-grid" style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px; margin-bottom: 15px; align-items: center;">
                    <div style="display: flex; flex-direction: column;">
                        <strong style="color: #D4AF37; font-size: 12px; margin-bottom: 5px;">COMPANY NAME:</strong>
                        <input type="text" id="clientCompany" placeholder="Enter Company Name" 
                               style="border: 1px solid #ccc; background: white; padding: 8px 12px; border-radius: 4px; font-size: 14px; width: 100%; font-weight: 500;">
                    </div>
                    <div style="display: flex; flex-direction: column;">
                        <strong style="color: #D4AF37; font-size: 12px; margin-bottom: 5px;">GST NUMBER:</strong>
                        <input type="text" id="clientGST" placeholder="Enter GST Number" 
                               style="border: 1px solid #ccc; background: white; padding: 8px 12px; border-radius: 4px; font-size: 14px; width: 100%; text-transform: uppercase;">
                    </div>
                </div>
                
                <!-- Row 2: Address (Full Width) -->
                <div style="margin-bottom: 15px;">
                    <strong style="color: #D4AF37; font-size: 12px; margin-bottom: 5px; display: block;">COMPLETE ADDRESS:</strong>
                    <textarea id="clientAddress" placeholder="Enter Complete Address" rows="2"
                             style="border: 1px solid #ccc; background: white; padding: 8px 12px; border-radius: 4px; font-size: 14px; width: 100%; resize: vertical; font-family: inherit;"></textarea>
                </div>
                
                <!-- Row 3: Contact and Email -->
                <div class="client-info-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px; align-items: center;">
                    <div style="display: flex; flex-direction: column;">
                        <strong style="color: #D4AF37; font-size: 12px; margin-bottom: 5px;">CONTACT NUMBER:</strong>
                        <input type="text" id="clientContact" placeholder="Enter Contact Number" 
                               style="border: 1px solid #ccc; background: white; padding: 8px 12px; border-radius: 4px; font-size: 14px; width: 100%;">
                    </div>
                    <div style="display: flex; flex-direction: column;">
                        <strong style="color: #D4AF37; font-size: 12px; margin-bottom: 5px;">EMAIL ADDRESS:</strong>
                        <input type="email" id="clientEmail" placeholder="Enter Email Address" 
                               style="border: 1px solid #ccc; background: white; padding: 8px 12px; border-radius: 4px; font-size: 14px; width: 100%;">
                    </div>
                </div>
                
                <!-- Row 4: Kind Attention (Centered) -->
                <div style="text-align: center; padding-top: 10px; border-top: 1px solid #eee;">
                    <strong style="color: #D4AF37; font-size: 12px; margin-bottom: 5px; display: block;">KIND ATTENTION:</strong>
                    <input type="text" id="clientAttention" placeholder="Enter Contact Person Name" 
                           style="border: 1px solid #ccc; background: white; padding: 8px 12px; border-radius: 4px; font-size: 14px; width: 300px; font-weight: 500; text-align: center;">
                </div>
            </div>
        </div>
        <div style="margin: 25px 0;">
            <h4 style="color: #D4AF37; margin-bottom: 15px; font-size: 16px; font-weight: bold;">üìã Crane Selection Details</h4>
            <table id="pdf-table" style="width: 100%; border-collapse: collapse; margin: 0; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                <thead>
                    <tr style="background: linear-gradient(135deg, #D4AF37, #c5a028);">
                        <th style="padding: 12px 15px; text-align: left; font-weight: 600; color: #1a1a1a; font-size: 14px; border-right: 1px solid rgba(26,26,26,0.1);">Crane Type</th>
                        <th style="padding: 12px 15px; text-align: center; font-weight: 600; color: #1a1a1a; font-size: 14px; border-right: 1px solid rgba(26,26,26,0.1);">Capacity (Tonnes)</th>
                        <th style="padding: 12px 15px; text-align: center; font-weight: 600; color: #1a1a1a; font-size: 14px; border-right: 1px solid rgba(26,26,26,0.1);">Qty</th>
                        <th style="padding: 12px 15px; text-align: right; font-weight: 600; color: #1a1a1a; font-size: 14px; border-right: 1px solid rgba(26,26,26,0.1);">Rate (Rs.)</th>
                        <th style="padding: 12px 15px; text-align: right; font-weight: 600; color: #1a1a1a; font-size: 14px;">Amount (Rs.)</th>
                    </tr>
                </thead>
                <tbody style="background: white;"></tbody>
                <tfoot>
                    <tr style="background: #f8f9fa; border-top: 2px solid #D4AF37;">
                        <td colspan="4" style="text-align: right; font-weight: bold; padding: 15px; color: #D4AF37; font-size: 16px;">Sub Total:</td>
                        <td id="pdf-subtotal" style="font-weight: bold; padding: 15px; text-align: right; color: #D4AF37; font-size: 16px; border-left: 1px solid #ddd;"></td>
                    </tr>
                </tfoot>
            </table>
        </div>
        
        <!-- Crane Images Section -->
        <div id="crane-images-section" style="margin: 30px 0; padding: 20px; background: #f9f9f9; border-radius: 8px; border: 1px solid #ddd;">
            <h4 style="color: #D4AF37; font-size: 18px; font-weight: bold; margin: 0 0 20px 0; text-align: center; padding: 10px; background: white; border-radius: 6px; border: 1px solid #D4AF37;">
                üèóÔ∏è Selected Crane Images
            </h4>
            <div id="crane-images-container" class="crane-images-container">
                <!-- Images will be dynamically added here -->
            </div>
        </div>
        
        <h4 style="color: #D4AF37; font-size: 18px; margin: 30px 0 20px 0; font-weight: bold;">Terms & Conditions</h4>
        <ul style="font-size: 14px; line-height: 1.8; color: #333; background: #f9f9f9; padding: 20px; border-radius: 8px; margin: 20px 0;">
            <li style="margin-bottom: 12px;"><b style="color: #D4AF37;">WARRANTY:</b> 1 YEAR DOMESTIC WARRANTY, INCLUDING ONLY PARTS & LABOR DEFECTS BUT NOT THE DEFECTS DUE TO EXTERNAL CAUSES ACCIDENTAL OR PHYSICAL DAMAGES</li>
            <li style="margin-bottom: 12px;"><b style="color: #D4AF37;">BANK DETAILS:</b> BANK OF INDIA A/C: 017820110000188 (IFSC: BKID0000178) BRANCH (VASAI WEST)</li>
            <li style="margin-bottom: 12px;"><b style="color: #D4AF37;">GST NO:</b> 27AAICE7407Q1Z0 | <b style="color: #D4AF37;">PAN No:</b> AAICE7407Q</li>
            <li style="margin-bottom: 12px;"><b style="color: #D4AF37;">PAYMENTS:</b> 50% ADVANCE WITH PURCHASE ORDER & 40% BEFORE DISPATCH & 10% BALANCE AFTER TESTING</li>
            <li style="margin-bottom: 12px;"><b style="color: #D4AF37;">DELIVERY PERIOD:</b> WITHIN 3-4 MONTH WORKING DAYS FROM THE DATE OF CONFIRMED PO ALONG WITH ADVANCE</li>
        </ul>
        <div style="text-align: center; margin-top: 30px; padding: 15px; background: #f0f0f0; border-radius: 8px; border-left: 4px solid #D4AF37;">
            <p style="margin: 0; font-size: 14px; color: #333; font-style: italic; font-weight: 600;">This is computer generated Quotation does not require any signature and stamp.</p>
        </div>
    </div>

    <script>
        // Crane images mapping
        const craneImages = {
            "Single Girder EOT Crane": {
                "0.5 Tonne": "https://via.placeholder.com/200x150/4CAF50/white?text=Single+Girder+EOT+0.5T",
                "1 Tonne": "https://via.placeholder.com/200x150/4CAF50/white?text=Single+Girder+EOT+1T",
                "2 Tonne": "https://via.placeholder.com/200x150/4CAF50/white?text=Single+Girder+EOT+2T",
                "5 Tonne": "https://via.placeholder.com/200x150/4CAF50/white?text=Single+Girder+EOT+5T",
                "10 Tonne": "https://via.placeholder.com/200x150/4CAF50/white?text=Single+Girder+EOT+10T",
                "15 Tonne": "https://via.placeholder.com/200x150/4CAF50/white?text=Single+Girder+EOT+15T",
                "20 Tonne": "https://via.placeholder.com/200x150/4CAF50/white?text=Single+Girder+EOT+20T",
                "Others": "https://via.placeholder.com/200x150/4CAF50/white?text=Single+Girder+EOT+Custom"
            },
            "Double Girder EOT Crane": {
                "2 Tonne": "https://via.placeholder.com/200x150/2196F3/white?text=Double+Girder+EOT+2T",
                "5 Tonne": "https://via.placeholder.com/200x150/2196F3/white?text=Double+Girder+EOT+5T",
                "10 Tonne": "https://via.placeholder.com/200x150/2196F3/white?text=Double+Girder+EOT+10T",
                "50 Tonne": "https://via.placeholder.com/200x150/2196F3/white?text=Double+Girder+EOT+50T",
                "100 Tonne": "https://via.placeholder.com/200x150/2196F3/white?text=Double+Girder+EOT+100T",
                "150 Tonne": "https://via.placeholder.com/200x150/2196F3/white?text=Double+Girder+EOT+150T",
                "250 Tonne": "https://via.placeholder.com/200x150/2196F3/white?text=Double+Girder+EOT+250T",
                "Others": "https://via.placeholder.com/200x150/2196F3/white?text=Double+Girder+EOT+Custom"
            },
            "Underslung EOT Crane": {
                "0.5 Tonne": "https://via.placeholder.com/200x150/FF9800/white?text=Underslung+EOT+0.5T",
                "1 Tonne": "https://via.placeholder.com/200x150/FF9800/white?text=Underslung+EOT+1T",
                "2 Tonne": "https://via.placeholder.com/200x150/FF9800/white?text=Underslung+EOT+2T",
                "5 Tonne": "https://via.placeholder.com/200x150/FF9800/white?text=Underslung+EOT+5T",
                "10 Tonne": "https://via.placeholder.com/200x150/FF9800/white?text=Underslung+EOT+10T",
                "Others": "https://via.placeholder.com/200x150/FF9800/white?text=Underslung+EOT+Custom"
            },
            "Single Girder Gantry Crane": {
                "1 Tonne": "https://via.placeholder.com/200x150/9C27B0/white?text=Single+Girder+Gantry+1T",
                "2 Tonne": "https://via.placeholder.com/200x150/9C27B0/white?text=Single+Girder+Gantry+2T",
                "5 Tonne": "https://via.placeholder.com/200x150/9C27B0/white?text=Single+Girder+Gantry+5T",
                "10 Tonne": "https://via.placeholder.com/200x150/9C27B0/white?text=Single+Girder+Gantry+10T",
                "15 Tonne": "https://via.placeholder.com/200x150/9C27B0/white?text=Single+Girder+Gantry+15T",
                "20 Tonne": "https://via.placeholder.com/200x150/9C27B0/white?text=Single+Girder+Gantry+20T",
                "Others": "https://via.placeholder.com/200x150/9C27B0/white?text=Single+Girder+Gantry+Custom"
            },
            "Double Girder Gantry Crane": {
                "5 Tonne": "https://via.placeholder.com/200x150/E91E63/white?text=Double+Girder+Gantry+5T",
                "10 Tonne": "https://via.placeholder.com/200x150/E91E63/white?text=Double+Girder+Gantry+10T",
                "50 Tonne": "https://via.placeholder.com/200x150/E91E63/white?text=Double+Girder+Gantry+50T",
                "100 Tonne": "https://via.placeholder.com/200x150/E91E63/white?text=Double+Girder+Gantry+100T",
                "200 Tonne": "https://via.placeholder.com/200x150/E91E63/white?text=Double+Girder+Gantry+200T",
                "500 Tonne": "https://via.placeholder.com/200x150/E91E63/white?text=Double+Girder+Gantry+500T",
                "Others": "https://via.placeholder.com/200x150/E91E63/white?text=Double+Girder+Gantry+Custom"
            },
            "Semi Gantry Crane": {
                "2 Tonne": "https://via.placeholder.com/200x150/795548/white?text=Semi+Gantry+2T",
                "5 Tonne": "https://via.placeholder.com/200x150/795548/white?text=Semi+Gantry+5T",
                "10 Tonne": "https://via.placeholder.com/200x150/795548/white?text=Semi+Gantry+10T",
                "15 Tonne": "https://via.placeholder.com/200x150/795548/white?text=Semi+Gantry+15T",
                "20 Tonne": "https://via.placeholder.com/200x150/795548/white?text=Semi+Gantry+20T",
                "50 Tonne": "https://via.placeholder.com/200x150/795548/white?text=Semi+Gantry+50T",
                "80 Tonne": "https://via.placeholder.com/200x150/795548/white?text=Semi+Gantry+80T",
                "Others": "https://via.placeholder.com/200x150/795548/white?text=Semi+Gantry+Custom"
            },
            "Wall Mounted Jib Crane": {
                "0.5 Tonne": "https://via.placeholder.com/200x150/607D8B/white?text=Wall+Jib+0.5T",
                "1 Tonne": "https://via.placeholder.com/200x150/607D8B/white?text=Wall+Jib+1T",
                "2 Tonne": "https://via.placeholder.com/200x150/607D8B/white?text=Wall+Jib+2T",
                "5 Tonne": "https://via.placeholder.com/200x150/607D8B/white?text=Wall+Jib+5T",
                "10 Tonne": "https://via.placeholder.com/200x150/607D8B/white?text=Wall+Jib+10T",
                "16 Tonne": "https://via.placeholder.com/200x150/607D8B/white?text=Wall+Jib+16T",
                "Others": "https://via.placeholder.com/200x150/607D8B/white?text=Wall+Jib+Custom"
            },
            "Pillar Mounted Jib Crane": {
                "0.5 Tonne": "https://via.placeholder.com/200x150/3F51B5/white?text=Pillar+Jib+0.5T",
                "1 Tonne": "https://via.placeholder.com/200x150/3F51B5/white?text=Pillar+Jib+1T",
                "2 Tonne": "https://via.placeholder.com/200x150/3F51B5/white?text=Pillar+Jib+2T",
                "5 Tonne": "https://via.placeholder.com/200x150/3F51B5/white?text=Pillar+Jib+5T",
                "10 Tonne": "https://via.placeholder.com/200x150/3F51B5/white?text=Pillar+Jib+10T",
                "16 Tonne": "https://via.placeholder.com/200x150/3F51B5/white?text=Pillar+Jib+16T",
                "Others": "https://via.placeholder.com/200x150/3F51B5/white?text=Pillar+Jib+Custom"
            },
            "Container Crane": {
                "20 Tonne": "https://via.placeholder.com/200x150/FF5722/white?text=Container+20T",
                "45 Tonne": "https://via.placeholder.com/200x150/FF5722/white?text=Container+45T",
                "Others": "https://via.placeholder.com/200x150/FF5722/white?text=Container+Custom"
            },
            "Small Gantry Crane": {
                "0.25 Tonne": "https://via.placeholder.com/200x150/8BC34A/white?text=Small+Gantry+0.25T",
                "0.50 Tonne": "https://via.placeholder.com/200x150/8BC34A/white?text=Small+Gantry+0.5T",
                "1 Tonne": "https://via.placeholder.com/200x150/8BC34A/white?text=Small+Gantry+1T",
                "2 Tonne": "https://via.placeholder.com/200x150/8BC34A/white?text=Small+Gantry+2T",
                "5 Tonne": "https://via.placeholder.com/200x150/8BC34A/white?text=Small+Gantry+5T",
                "10 Tonne": "https://via.placeholder.com/200x150/8BC34A/white?text=Small+Gantry+10T",
                "Others": "https://via.placeholder.com/200x150/8BC34A/white?text=Small+Gantry+Custom"
            },
            "Wire Rope Electric Hoist": {
                "0.5 Tonne": "https://via.placeholder.com/200x150/00BCD4/white?text=Wire+Rope+0.5T",
                "1 Tonne": "https://via.placeholder.com/200x150/00BCD4/white?text=Wire+Rope+1T",
                "2 Tonne": "https://via.placeholder.com/200x150/00BCD4/white?text=Wire+Rope+2T",
                "5 Tonne": "https://via.placeholder.com/200x150/00BCD4/white?text=Wire+Rope+5T",
                "10 Tonne": "https://via.placeholder.com/200x150/00BCD4/white?text=Wire+Rope+10T",
                "20 Tonne": "https://via.placeholder.com/200x150/00BCD4/white?text=Wire+Rope+20T",
                "36 Tonne": "https://via.placeholder.com/200x150/00BCD4/white?text=Wire+Rope+36T",
                "Others": "https://via.placeholder.com/200x150/00BCD4/white?text=Wire+Rope+Custom"
            },
            "Electric Chain Hoist": {
                "0.5 Tonne": "https://via.placeholder.com/200x150/CDDC39/white?text=Chain+Hoist+0.5T",
                "1 Tonne": "https://via.placeholder.com/200x150/CDDC39/white?text=Chain+Hoist+1T",
                "2 Tonne": "https://via.placeholder.com/200x150/CDDC39/white?text=Chain+Hoist+2T",
                "5 Tonne": "https://via.placeholder.com/200x150/CDDC39/white?text=Chain+Hoist+5T",
                "10 Tonne": "https://via.placeholder.com/200x150/CDDC39/white?text=Chain+Hoist+10T",
                "15 Tonne": "https://via.placeholder.com/200x150/CDDC39/white?text=Chain+Hoist+15T",
                "25 Tonne": "https://via.placeholder.com/200x150/CDDC39/white?text=Chain+Hoist+25T",
                "35 Tonne": "https://via.placeholder.com/200x150/CDDC39/white?text=Chain+Hoist+35T",
                "Others": "https://via.placeholder.com/200x150/CDDC39/white?text=Chain+Hoist+Custom"
            }
        };

        // JSON data for cranes and capacities
        const cranesData = {
            "Single Girder EOT Crane": ["0.5 Tonne", "1 Tonne", "2 Tonne", "5 Tonne", "10 Tonne", "15 Tonne", "20 Tonne", "Others"],
            "Double Girder EOT Crane": ["2 Tonne", "5 Tonne", "10 Tonne", "50 Tonne", "100 Tonne", "150 Tonne", "250 Tonne", "Others"],
            "Underslung EOT Crane": ["0.5 Tonne", "1 Tonne", "2 Tonne", "5 Tonne", "10 Tonne", "Others"],
            "Single Girder Gantry Crane": ["1 Tonne", "2 Tonne", "5 Tonne", "10 Tonne", "15 Tonne", "20 Tonne", "Others"],
            "Double Girder Gantry Crane": ["5 Tonne", "10 Tonne", "50 Tonne", "100 Tonne", "200 Tonne", "500 Tonne", "Others"],
            "Semi Gantry Crane": ["2 Tonne", "5 Tonne", "10 Tonne", "15 Tonne", "20 Tonne", "50 Tonne", "80 Tonne", "Others"],
            "Wall Mounted Jib Crane": ["0.5 Tonne", "1 Tonne", "2 Tonne", "5 Tonne", "10 Tonne", "16 Tonne", "Others"],
            "Pillar Mounted Jib Crane": ["0.5 Tonne", "1 Tonne", "2 Tonne", "5 Tonne", "10 Tonne", "16 Tonne", "Others"],
            "Container Crane": ["20 Tonne", "45 Tonne", "Others"],
            "Small Gantry Crane": ["0.25 Tonne", "0.50 Tonne", "1 Tonne", "2 Tonne", "5 Tonne", "10 Tonne", "Others"],
            "Wire Rope Electric Hoist": ["0.5 Tonne", "1 Tonne", "2 Tonne", "5 Tonne", "10 Tonne", "20 Tonne", "36 Tonne", "Others"],
            "Electric Chain Hoist": ["0.5 Tonne", "1 Tonne", "2 Tonne", "5 Tonne", "10 Tonne", "15 Tonne", "25 Tonne", "35 Tonne", "Others"]
        };

        function addRow(crane = '', capacity = '', qty = 0, rate = 0) {
            const div = document.createElement('div');
            div.classList.add('dynamic-row');

            // Crane dropdown
            const craneSelect = document.createElement('select');
            for (const craneType in cranesData) {
                const option = document.createElement('option');
                option.value = craneType;
                option.textContent = craneType;
                if (craneType === crane) option.selected = true;
                craneSelect.appendChild(option);
            }

            // Capacity dropdown
            const capacitySelect = document.createElement('select');
            function updateCapacityOptions(selectedCrane) {
                capacitySelect.innerHTML = '';
                cranesData[selectedCrane].forEach(cap => {
                    const opt = document.createElement('option');
                    opt.value = cap;
                    opt.textContent = cap;
                    if (cap == capacity) opt.selected = true;
                    capacitySelect.appendChild(opt);
                });
            }
            updateCapacityOptions(craneSelect.value);

            // Show input if 'Other' is selected
            const otherInput = document.createElement('input');
            otherInput.type = 'number';
            otherInput.placeholder = 'Enter capacity';
            otherInput.style.display = capacitySelect.value === 'Others' ? 'block' : 'none';
            if (capacitySelect.value !== 'Others') otherInput.value = '';

            capacitySelect.addEventListener('change', () => {
                if (capacitySelect.value === 'Others') {
                    otherInput.style.display = 'block';
                } else {
                    otherInput.style.display = 'none';
                    otherInput.value = '';
                }
            });

            craneSelect.addEventListener('change', () => {
                updateCapacityOptions(craneSelect.value);
                if (capacitySelect.value === 'Others') otherInput.style.display = 'block';
                else otherInput.style.display = 'none';
                updateCraneImages();
            });

            capacitySelect.addEventListener('change', () => {
                if (capacitySelect.value === 'Others') {
                    otherInput.style.display = 'block';
                } else {
                    otherInput.style.display = 'none';
                    otherInput.value = '';
                }
                updateCraneImages();
            });

            otherInput.addEventListener('input', () => {
                updateCraneImages();
            });

            // Quantity, Rate, Amount
            const qtyInput = document.createElement('input');
            qtyInput.type = 'number'; qtyInput.value = qty; qtyInput.placeholder = 'Qty';
            qtyInput.min = 0; qtyInput.oninput = () => calculateAmt(div);

            const rateInput = document.createElement('input');
            rateInput.type = 'number'; rateInput.value = rate; rateInput.placeholder = 'Rate';
            rateInput.min = 0; rateInput.oninput = () => calculateAmt(div);

            const amtInput = document.createElement('input');
            amtInput.type = 'number'; amtInput.placeholder = 'Amt'; amtInput.value = 0; amtInput.readOnly = true;

            const removeBtn = document.createElement('button');
            removeBtn.type = 'button'; 
            removeBtn.textContent = 'üóëÔ∏è Remove';
            removeBtn.className = 'btn btn-danger';
            removeBtn.onclick = () => {
                div.remove();
                updateCraneImages();
            };

            div.appendChild(craneSelect);
            div.appendChild(capacitySelect);
            div.appendChild(otherInput);
            div.appendChild(qtyInput);
            div.appendChild(rateInput);
            div.appendChild(amtInput);
            div.appendChild(removeBtn);

            document.getElementById('tableRows').appendChild(div);
        }

        function calculateAmt(row) {
            const qty = parseFloat(row.children[3].value) || 0;
            const rate = parseFloat(row.children[4].value) || 0;
            row.children[5].value = qty * rate;
        }

        function updateCraneImages() {
            const container = document.getElementById('crane-images-container');
            container.innerHTML = '';
            
            // Get unique crane selections
            const selectedCranes = new Set();
            document.querySelectorAll('#tableRows .dynamic-row').forEach(row => {
                const crane = row.children[0].value;
                let capacity = row.children[1].value;
                if (capacity === 'Others') capacity = row.children[2].value || 'Others';
                selectedCranes.add(JSON.stringify({crane, capacity}));
            });

            selectedCranes.forEach(craneData => {
                const {crane, capacity} = JSON.parse(craneData);
                const imageUrl = craneImages[crane] && craneImages[crane][capacity] 
                    ? craneImages[crane][capacity] 
                    : 'https://via.placeholder.com/200x150/CCCCCC/white?text=No+Image';
                
                const imageDiv = document.createElement('div');
                imageDiv.className = 'crane-image-item';
                
                const img = document.createElement('img');
                img.src = imageUrl;
                img.alt = `${crane} - ${capacity}`;
                
                const label = document.createElement('div');
                label.className = 'label';
                label.textContent = `${crane} - ${capacity}`;
                
                imageDiv.appendChild(img);
                imageDiv.appendChild(label);
                container.appendChild(imageDiv);
            });
        }

        function generatePDF() {
            // Show loading message
            showPDFLoadingMessage();
            
            const pdfPreview = document.getElementById('pdf-preview');
            const pdfTableBody = document.querySelector('#pdf-table tbody');
            const pdfSubtotal = document.getElementById('pdf-subtotal');
            const pdfDate = document.getElementById('pdf-date');
            const pdfTime = document.getElementById('pdf-time');
            const pdfQuotationRef = document.getElementById('pdf-quotationRef');

            // Set current date and time if not provided
            const quotationDate = document.getElementById('quotationDate').value || new Date().toISOString().split('T')[0];
            const quotationTime = document.getElementById('quotationTime').value || new Date().toTimeString().split(' ')[0].substring(0, 5);
            const quotationRef = document.getElementById('quotationRef').value || 'ECMPL/306/25-26';
            
            pdfDate.textContent = quotationDate;
            pdfTime.textContent = quotationTime;
            pdfQuotationRef.textContent = quotationRef;

            // Update client information
            document.getElementById('clientCompany').value = document.getElementById('clientCompanyInput').value || '';
            document.getElementById('clientGST').value = document.getElementById('clientGSTInput').value || '';
            document.getElementById('clientAddress').value = document.getElementById('clientAddressInput').value || '';
            document.getElementById('clientContact').value = document.getElementById('clientContactInput').value || '';
            document.getElementById('clientEmail').value = document.getElementById('clientEmailInput').value || '';
            document.getElementById('clientAttention').value = document.getElementById('clientAttentionInput').value || '';

            // Update crane images
            updateCraneImages();

            pdfTableBody.innerHTML = '';
            let subtotal = 0;

            document.querySelectorAll('#tableRows .dynamic-row').forEach(row => {
                const crane = row.children[0].value;
                let capacity = row.children[1].value;
                if (capacity === 'Others') capacity = row.children[2].value || 'N/A';
                const qty = row.children[3].value;
                const rate = row.children[4].value;
                const amt = row.children[5].value;

                subtotal += parseFloat(amt) || 0;

                const tr = document.createElement('tr');
                tr.innerHTML = `<td>${crane}</td><td>${capacity}</td><td>${qty}</td><td>${rate}</td><td>${amt}</td>`;
                pdfTableBody.appendChild(tr);
            });

            pdfSubtotal.textContent = subtotal.toLocaleString("en-IN");

            // Generate PDF with multiple pages
            generateMultiPagePDF();
        }

        function showPDFLoadingMessage() {
            // Create loading overlay
            const loadingOverlay = document.createElement('div');
            loadingOverlay.id = 'pdf-loading-overlay';
            loadingOverlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                z-index: 10000;
                color: white;
                font-family: 'Inter', sans-serif;
            `;
            
            loadingOverlay.innerHTML = `
                <div style="text-align: center; padding: 40px; background: white; border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.3);">
                    <div style="font-size: 48px; margin-bottom: 20px; animation: spin 2s linear infinite;">‚öôÔ∏è</div>
                    <h3 style="color: #d32f2f; margin-bottom: 15px; font-size: 24px;">Generating PDF...</h3>
                    <p style="color: #666; margin-bottom: 20px; font-size: 16px;">Please wait while we process your quotation</p>
                    <div style="display: flex; justify-content: center; gap: 10px; font-size: 24px;">
                        <span style="animation: bounce 1s infinite;">üìÑ</span>
                        <span style="animation: bounce 1s infinite 0.1s;">üîÑ</span>
                        <span style="animation: bounce 1s infinite 0.2s;">‚ö°</span>
                        <span style="animation: bounce 1s infinite 0.3s;">‚ú®</span>
                    </div>
                </div>
                <style>
                    @keyframes spin {
                        0% { transform: rotate(0deg); }
                        100% { transform: rotate(360deg); }
                    }
                    @keyframes bounce {
                        0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
                        40% { transform: translateY(-10px); }
                        60% { transform: translateY(-5px); }
                    }
                </style>
            `;
            
            document.body.appendChild(loadingOverlay);
        }
        
        function hidePDFLoadingMessage() {
            const loadingOverlay = document.getElementById('pdf-loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.remove();
            }
        }

        function generateMultiPagePDF() {
            const pdf = new window.jspdf.jsPDF('p', 'pt', 'a4');
            
            const element = document.getElementById('pdf-preview');
            
            window.html2canvas(element, {
                scale: 2,
                useCORS: true,
                allowTaint: true,
                backgroundColor: '#ffffff'
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const imgWidth = 210;
                const pageHeight = 295;
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;

                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;

                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }

                pdf.save('ekta-crane-quotation.pdf');
                
                setTimeout(() => {
                    hidePDFLoadingMessage();
                }, 500);
            });
        }

        // Initialize with default values
        document.getElementById('quotationDate').value = new Date().toISOString().split('T')[0];
        document.getElementById('quotationTime').value = new Date().toTimeString().split(' ')[0].substring(0, 5);
        
        addRow(); // initialize with one row
    </script>

</body>

</html>
